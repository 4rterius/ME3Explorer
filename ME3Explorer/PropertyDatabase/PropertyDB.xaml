<global:WPFBase
    xmlns:global="clr-namespace:ME3Explorer" x:Class="ME3Explorer.PropertyDatabase.PropertyDB"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        xmlns:local="clr-namespace:ME3Explorer.PropertyDatabase"
        xmlns:SharedUI="clr-namespace:ME3Explorer.SharedUI"
        xmlns:Converters="clr-namespace:ME3Explorer.SharedUI.Converters"
        xmlns:system="clr-namespace:System;assembly=mscorlib"
        Closing="PropertyDB_Closing"
        AllowDrop="True"
        Icon="/Resources/propertydatabase_256x256.ico"
        Title="Property Database WPF" Height="450" Width="900"
        DataContext="{Binding RelativeSource={RelativeSource Self}}">
    <Window.Resources>
        <Converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <Converters:NullEnabledConverter x:Key="NullEnabledConverter"/>
        <Converters:NullVisibilityConverter x:Key="NullVisibilityConverter"/>
        <Converters:PackageEditorWPFActiveViewHighlightConverter x:Key="PackageEditorWPFActiveViewHighlightConverter"/>
        <Converters:ObjectStructPropertyTypeConverter x:Key="ObjectStructPropertyTypeConverter"/>
        <Converters:EntryFileTypeConverter x:Key="EntryFileTypeConverter"/>
        <Converters:EntryFileTypeIconPathConverter x:Key="EntryFileTypeIconPathConverter"/>
        <Converters:EmbeddedFileToolTipConverter x:Key="EmbeddedFileToolTipConverter"/>
        <Converters:GameTypeConverter x:Key="GameTypeConverter"/>
    </Window.Resources>
    <DockPanel>
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="Database" Padding="4" >
                <MenuItem Header="Generate" Command="{Binding GenerateDBCommand}" InputGestureText="Ctrl+G" ToolTip="Scan Game Properties"/>
                <MenuItem Header="Save"  Command="{Binding SaveDBCommand}" InputGestureText="Ctrl+S" ToolTip="Save database in-place" IsEnabled="{Binding Pcc, Converter={StaticResource NullEnabledConverter}}"/>
                <Separator />
                <MenuItem Name="switchME1_menu" Header="ME1 Properties" Command="{Binding SwitchMECommand}" CommandParameter="ME1" InputGestureText="Ctrl+1" ToolTip="Switch to ME1 Properties"/>
                <MenuItem Name="switchME2_menu" Header="ME2 Properties" Command="{Binding SwitchMECommand}" CommandParameter="ME2" InputGestureText="Ctrl+2" ToolTip="Switch to ME2 Properties"/>
                <MenuItem Name="switchME3_menu" Header="ME3 Properties" Command="{Binding SwitchMECommand}" CommandParameter="ME3" InputGestureText="Ctrl+3" ToolTip="Switch to ME3 Properties"/>
            </MenuItem>

            <MenuItem Header="Tools" Padding="4">
                <MenuItem Header="Open Definition" Command="{Binding OpenSourcePkgCommand}" ToolTip="Opens this class definition in Package Editor."/>
                <MenuItem Header="Open Usage" Command="{Binding OpenSourcePkgCommand}" ToolTip="Opens this Usage in Package Editor." />
                <MenuItem Header="Go to SuperClass" Command="{Binding GoToSuperclassCommand}" ToolTip="Go to the superclass for more properties."/>
                <MenuItem Header="Show Defaults" Command="{Binding OpenSourcePkgCommand}" ToolTip="Show default values only." />
            </MenuItem>
        </Menu>
        <StatusBar Height="33" DockPanel.Dock="Bottom">
            <StatusBarItem VerticalContentAlignment="Center" x:Name="StatusBar_GameID_Container" Visibility="Visible" Margin="0,0,0,0">
                <Border BorderBrush="Gray" BorderThickness="2,2,2,2" CornerRadius="3,3,3,3" VerticalAlignment="Center">
                    <TextBlock x:Name="StatusBar_GameID_Text" Background="DarkSeaGreen" Text="{Binding currentGame}" FontSize="11" Foreground="White" Padding="4,3,4,3" FontFamily="Consolas" VerticalAlignment="Center"/>
                </Border>
            </StatusBarItem>
            <StatusBarItem>
                <TextBlock x:Name="StatusBar_LeftMostText" Text="{Binding CurrentOverallOperationText}"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <StackPanel Orientation="Horizontal">
                    <Button Name="StatusBar_CancelBtn" Command="{Binding CancelDumpCommand}" Content="Cancel" Width="79" Margin="2,1" HorizontalAlignment="Right" Visibility="Hidden"/>
                    <TextBlock Name="StatusBar_RightSide_LastSaved" Text="{Binding CurrentDatabase.GenerationDate, StringFormat='Generated at {0}'}" Foreground="Gray" Visibility="Visible"/>
                    <ProgressBar x:Name="StatusBar_Progress" Value="{Binding OverallProgressValue}" Maximum="{Binding OverallProgressMaximum}" Height="24" HorizontalAlignment="Stretch" Width="100" Visibility="Hidden"/>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>
        <DockPanel>
            <SharedUI:ListBoxScroll x:Name="lstbx_Classes" DockPanel.Dock="Left" MinWidth="300" ItemsSource="{Binding Path=CurrentDataBase.ClassRecords}"  DisplayMemberPath="Class" SelectedItem="{Binding CurrentClass, Mode=TwoWay}">
                <SharedUI:ListBoxScroll.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Open Class Definition" Command="{Binding OpenSourcePkgCommand}" ToolTip="Opens this class definition in Package Editor." />
                        <MenuItem Header="Go to SuperClass" Command="{Binding GoToSuperclassCommand}" ToolTip="Go to the superclass for more properties."/>
                    </ContextMenu>
                </SharedUI:ListBoxScroll.ContextMenu>
            </SharedUI:ListBoxScroll>
            <SharedUI:ListBoxScroll x:Name="lstbx_Properties" MinWidth="200" ItemsSource="{Binding SelectedItem.PropertyRecords, ElementName=lstbx_Classes }" >
                <SharedUI:ListBoxScroll.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="{Binding Property}" />
                            <TextBlock FontSize="10" Text=" (" VerticalAlignment="Center"/>
                            <TextBlock FontSize="10" Text="{Binding Type}" VerticalAlignment="Center"/>
                            <TextBlock FontSize="10" Text=")" VerticalAlignment="Center" />
                        </StackPanel>
                    </DataTemplate>
                </SharedUI:ListBoxScroll.ItemTemplate>
                <SharedUI:ListBoxScroll.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Open Class Definition" Command="{Binding OpenSourcePkgCommand}" ToolTip="Opens this class definition in Package Editor." />
                        <MenuItem Header="Go to SuperClass" Command="{Binding GoToSuperclassCommand}" ToolTip="Go to the superclass for more properties."/>
                    </ContextMenu>
                </SharedUI:ListBoxScroll.ContextMenu>
            </SharedUI:ListBoxScroll>
            <SharedUI:ListBoxScroll x:Name="lstbx_Values" DockPanel.Dock="Right" MinWidth="200" ItemsSource="{Binding SelectedItem.PropertyUsages, ElementName=lstbx_Properties }" >
                <SharedUI:ListBoxScroll.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="{Binding Filename}" />
                            <TextBlock Text=" #"/>
                            <TextBlock Text="{Binding ExportUID}" />
                            <TextBlock Text=" Value:" />
                            <TextBlock Text="{Binding Value}" />
                            <TextBlock Text=" default:" />
                            <TextBlock Text="{Binding IsDefault}" />
                        </StackPanel>
                    </DataTemplate>
                </SharedUI:ListBoxScroll.ItemTemplate>
                <SharedUI:ListBoxScroll.ItemContainerStyle>
                    <Style>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsDefault}">
                                <Setter Property="TextBlock.FontWeight" Value="Bold"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </SharedUI:ListBoxScroll.ItemContainerStyle>
                <SharedUI:ListBoxScroll.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Open Class Definition" Command="{Binding OpenSourcePkgCommand}" ToolTip="Opens this class definition in Package Editor." />
                        <MenuItem Header="Go to SuperClass" Command="{Binding GoToSuperclassCommand}" ToolTip="Go to the superclass for more properties."/>
                    </ContextMenu>
                </SharedUI:ListBoxScroll.ContextMenu>
            </SharedUI:ListBoxScroll>
        </DockPanel>
    </DockPanel>
</global:WPFBase>
